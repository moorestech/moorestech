{
  "$id": "challenges",
  "type": "object",
  "isDefaultOpen": true,

  "properties": {
    "data": {
      "type": "array",
      "overrideCodeGeneratePropertyName": "ChallengeMasterElement",

      "items": {
        "type": "object",
        "properties": {

          "challengeGuid": {
            "type": "string",
            "format": "uuid",
            "autoGenerated": true
          },

          "prevChallengeGuids": {
            "type": "array",
            "optional": true,
            "items": {
              "type": "string",
              "format": "uuid",
              "foreignKey": "challenges:challengeGuid:title"
            }
          },

          "title": {
            "type": "string",
            "default": "New Challenge"
          },

          "summary": {
            "type": "string",
            "default": "New Challenge summary"
          },

          "playSkitType": {
            "type": "string",
            "default": "createItem",
            "enum": ["None", "BackgroundSkit"]
          },

          "playSkitParam": {
            "oneOf": [
              {
                "if": {
                  "properties": {
                    "playSkitType": { "const": "None" }
                  }
                },
                "then": {
                  "type": "object",
                  "properties": {
                  }
                }
              },
              {
                "if": {
                  "properties": {
                    "playSkitType": { "const": "BackgroundSkit" }
                  }
                },
                "then": {
                  "type": "object",
                  "properties": {
                    "fireSkitName": {
                      "type": "string"
                    }
                  }
                }
              }
            ]
          },

          "taskCompletionType": {
            "type": "string",
            "default": "createItem",
            "enum": ["createItem", "inInventoryItem","blockPlace"]
          },

          "taskParam": {
            "oneOf": [
              {
                "if": {
                  "properties": {
                    "taskCompletionType": { "const": "createItem" }
                  }
                },
                "then": {
                  "type": "object",
                  "properties": {
                    "itemGuid": {
                      "type": "string",
                      "format": "uuid",
                      "foreignKey": "items:itemGuid:name"
                    }
                  }
                }
              },
              {
                "if": {
                  "properties": {
                    "taskCompletionType": { "const": "inInventoryItem" }
                  }
                },
                "then": {
                  "type": "object",
                  "properties": {
                    "itemGuid": {
                      "type": "string",
                      "format": "uuid",
                      "foreignKey": "items:itemGuid:name"
                    },
                    "itemCount": {
                      "type": "integer",
                      "default": 1
                    }
                  }
                }
              },
              {
                "if": {
                  "properties": {
                    "taskCompletionType": { "const": "blockPlace" }
                  }
                },
                "then": {
                  "type": "object",
                  "properties": {

                    "blockGuid": {
                      "type": "string",
                      "format": "uuid",
                      "foreignKey": "blocks:blockGuid:name"
                    },
                    "itemCount": {
                      "type": "integer",
                      "default": 1
                    }

                  }
                }
              }
            ]
          },


          "tutorials": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {

                "tutorialType": {
                  "type": "string",
                  "default": "uiHighLight",
                  "enum": ["mapObjectPin", "keyControl", "uiHighLight","itemViewHighLight"]
                },

                "tutorialParam": {
                  "oneOf": [
                    {
                      "if": {
                        "properties": {
                          "tutorialType": { "const": "mapObjectPin" }
                        }
                      },
                      "then": {
                        "type": "object",
                        "properties": {
                          "mapObjectGuid": {
                            "type": "string",
                            "format": "uuid",
                            "foreignKey": "mapObjects:mapObjectGuid:mapObjectName"
                          },
                          "pinText": {
                            "type": "string",
                            "default": "pin text"
                          }
                        }
                      }
                    },
                    {
                      "if": {
                        "properties": {
                          "tutorialType": { "const": "keyControl" }
                        }
                      },
                      "then": {
                        "type": "object",
                        "properties": {
                          "uiState": {
                            "type": "string",
                            "enum" : ["GameScreen","PlayerInventory", "BlockInventory", "PauseMenu","DeleteBar","Story","PlaceBlock"],
                            "default": "GameScreen"
                          },
                          "controlText": {
                            "type": "string",
                            "default": "control text"
                          }
                        }
                      }
                    },
                    {
                      "if": {
                        "properties": {
                          "tutorialType": { "const": "uiHighLight" }
                        }
                      },
                      "then": {
                        "type": "object",
                        "properties": {
                          "highLightUIObjectId": {
                            "type": "string",
                            "default": "ui object id"
                          },
                          "highLightText": {
                            "type": "string",
                            "default": "highlight text"
                          }
                        }
                      }
                    },
                    {
                      "if": {
                        "properties": {
                          "tutorialType": { "const": "itemViewHighLight" }
                        }
                      },
                      "then": {
                        "type": "object",
                        "properties": {
                          "highLightItemGuid": {
                            "type": "string",
                            "format": "uuid",
                            "foreignKey": "items:itemGuid:name"
                          },
                          "highLightText": {
                            "type": "string",
                            "default": "highlight text"
                          }
                        }
                      }
                    }
                  ]
                }
              }
            }
          },

          "clearedActions": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {

                "clearedActionType": {
                  "type": "string",
                  "enum": ["unlockCraftRecipe", "unlockItemRecipeView", "unlockChallenge"]
                },

                "clearedActionParam": {
                  "oneOf": [
                    {
                      "if": {
                        "properties": {
                          "clearedActionType": { "const": "unlockCraftRecipe" }
                        }
                      },
                      "then": {
                        "type": "object",
                        "properties": {

                          "unlockRecipeGuids": {

                            "type": "array",

                            "items": {
                              "type": "string",
                              "format": "uuid",
                              "foreignKey": "craftRecipes:craftRecipeGuid:craftRecipeGuid"
                            }
                          }
                        }
                      }
                    },
                    {
                      "if": {
                        "properties": {
                          "clearedActionType": { "const": "unlockItemRecipeView" }
                        }
                      },
                      "then": {
                        "type": "object",
                        "properties": {

                          "unlockItemGuids": {

                            "type": "array",

                            "items": {
                              "type": "string",
                              "format": "uuid",
                              "foreignKey": "items:itemGuid:name"
                            }
                          }

                        }
                      }
                    },
                    {
                      "if": {
                        "properties": {
                          "clearedActionType": { "const": "unlockChallenge" }
                        }
                      },
                      "then": {
                        "type": "object",
                        "properties": {

                          "unlockItemGuids": {

                            "type": "array",

                            "items": {
                              "type": "string",
                              "format": "uuid",
                              "foreignKey": "challenges:challengeGuid:title"
                            }
                          }

                        }
                      }
                    }

                  ]
                }
              }
            }
          },

          "displayListType" :{
            "type": "string",
            "default": "createItem",
            "enum": ["IsUnlocked", "ForceShow", "ForceHide"],

            "$memo": "ここはbooleanにしたいけど、コード生成側の都合で出来ないのでいったんstringにしている"
          },

          "displayListParam": {
            "type": "object",
            "properties": {

              "UIPosition": {
                "type": "array",
                "pattern": "@vector2",
                "items": {
                  "type": "number"
                },
                "default": [0,0],

                "overrideCodeGeneratePropertyName": "DisplayInChallengeListPosition"
              },

              "UIScale": {
                "type": "array",
                "pattern": "@vector3",
                "items": {
                  "type": "number"
                },
                "default": [0,0,0],

                "overrideCodeGeneratePropertyName": "DisplayInChallengeListScale"
              },

              "IconItem": {
                "type": "string",
                "format": "uuid",
                "foreignKey": "items:itemGuid:name",
                "optional": true,

                "overrideCodeGeneratePropertyName": "DisplayInChallengeListIconItemGuid"
              }

            }

          }
        }
      }
    }
  }
}
