---
name:remove-git-worktree
---

以下のgit worktreeクリーンアップワークフローを実行してください：

## ワークフロー

### フェーズ1: 削除対象の特定と確認
1. `git worktree list`を使用して現在のすべてのgit worktreeを一覧表示する
2. メインリポジトリ（プロジェクトルートにあるもの）を除くすべてのworktreeを特定する
3. 削除対象の各worktreeに対して：
   - worktreeのパスと関連付けられたブランチ名を抽出する
   - 各worktreeの状態を確認（コミットされていない変更の有無等）

### フェーズ2: ユーザーへの確認
削除対象のworktreeを以下の形式で表示し、**必ず確認を求める**：

```
削除対象のworktreeが見つかりました：
1. [パス] -> ブランチ: [ブランチ名] [状態情報]
2. [パス] -> ブランチ: [ブランチ名] [状態情報]

削除を実行しますか？
  y  - 通常削除（コミットされていない変更がある場合は削除をスキップ）
  fy - 強制削除（コミットされていない変更も含めてすべて削除）
  n  - 終了
```

### フェーズ3: 削除の実行
ユーザーの入力に応じて：
- **y**: 各worktreeに対して
  - `git worktree remove <path>` を実行
  - 失敗した場合はエラー内容を表示し、そのworktreeはスキップ
  - 成功した場合は `git branch -D <branch-name>` でブランチも削除
- **fy**: 各worktreeに対して
  - `git worktree remove --force <path>` を実行
  - 成功した場合は `git branch -D <branch-name>` でブランチも削除
- **n**: 処理を中止

### フェーズ4: 確認と再実行
すべての削除処理完了後：
1. `git worktree list`で再度確認し、メイン以外のworktreeが残っていないかチェック
2. `git branch`でworktreeに紐づいていたブランチが残っていないかチェック
3. **残りがある場合**：
   - 残っているworktreeとブランチを表示
   - フェーズ2に戻り、同じ確認プロンプトで再度処理を行う
4. **すべて削除された場合**：
   - 削除完了のサマリーを表示して終了

## 重要な安全上の考慮事項
- メインworktree（/Users/sato-katsumi/moorestechにあるもの）は**絶対に削除しない**
- 削除は**必ずユーザーの明示的な確認後にのみ実行**する
- ブランチが存在しない、または既に削除されている等のエッジケースに適切に対応する
- 各削除処理の成功/失敗を明確にログ出力する

## 期待される動作例
```
削除対象のworktreeが見つかりました：
1. /Users/sato-katsumi/moorestech-feature-a -> ブランチ: feature/new-system (クリーン)
2. /Users/sato-katsumi/moorestech-feature-b -> ブランチ: feature/old-fix (未コミットの変更あり)

削除を実行しますか？
  y  - 通常削除（コミットされていない変更がある場合は削除をスキップ）
  fy - 強制削除（コミットされていない変更も含めてすべて削除）
  n  - 終了

→ [ユーザー入力を待つ]
```