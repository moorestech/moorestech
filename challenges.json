{
  "$id": "challenges",
  "type": "object",
  "required": ["data"],
  "isDefaultOpen": true,

  "properties": {
    "data": {
      "type": "array",
      "overrideCodeGeneratePropertyName": "ChallengeElement",

      "items": {
        "type": "object",
        "required": ["challengeId","prevId", "title", "summary", "taskCompletionType", "taskParam", "tutorials"],
        "properties": {

          "challengeGuid": {
            "type": "string",
            "format": "uuid",
            "autoGenerated": true
          },

          "prevChallengeGuid": {
            "type": "string",
            "format": "uuid",
            "foreignKey": "challenges:challengeGuid:title"
          },

          "title": {
            "type": "string",
            "default": "New Challenge"
          },

          "summary": {
            "type": "string",
            "default": "New Challenge summary"
          },

          "taskCompletionType": {
            "type": "string",
            "default": "createItem",
            "enum": ["createItem", "inInventoryItem","blockPlace"]
          },

          "taskParam": {
            "oneOf": [
              {
                "if": {
                  "properties": {
                    "taskCompletionType": { "const": "createItem" }
                  }
                },
                "then": {
                  "type": "object",
                  "required": ["itemGuid"],
                  "properties": {
                    "itemGuid": {
                      "type": "string",
                      "format": "uuid",
                      "foreignKey": "items:itemGuid:name"
                    }
                  }
                }
              },
              {
                "if": {
                  "properties": {
                    "taskCompletionType": { "const": "inInventoryItem" }
                  }
                },
                "then": {
                  "type": "object",
                  "required": ["itemGuid", "itemCount"],
                  "properties": {
                    "itemGuid": {
                      "type": "string",
                      "format": "uuid",
                      "foreignKey": "items:itemGuid:name"
                    },
                    "itemCount": {
                      "type": "integer",
                        "default": 1
                    }
                  }
                }
              },
              {
                "if": {
                  "properties": {
                    "taskCompletionType": { "const": "blockPlace" }
                  }
                },
                "then": {
                  "type": "object",
                  "required": ["blockGuid"],
                  "properties": {

                    "blockGuid": {
                      "type": "string",
                      "format": "uuid",
                      "foreignKey": "blocks:blockGuid:name"
                    },
                    "itemCount": {
                      "type": "integer",
                        "default": 1
                    }

                  }
                }
              }
            ]
          },


          "tutorials": {
            "type": "array",
            "items": {
              "type": "object",
              "required": ["tutorialType", "tutorialParam"],
              "properties": {

                "tutorialType": {
                  "type": "string",
                  "default": "uiHighLight",
                  "enum": ["mapObjectPin", "keyControl", "uiHighLight"]
                },

                "tutorialParam": {
                  "oneOf": [
                    {
                      "if": {
                        "properties": {
                          "tutorialType": { "const": "mapObjectPin" }
                        }
                      },
                      "then": {
                        "type": "object",
                        "required": ["mapObjectType", "pinText"],
                        "properties": {
                          "mapObjectType": {
                            "type": "string",
                            "foreignKey": "mapObjects:mapObjectType:mapObjectType"
                          },
                          "pinText": {
                            "type": "string",
                            "default": "pin text"
                          }
                        }
                      }
                    },
                    {
                      "if": {
                        "properties": {
                          "tutorialType": { "const": "keyControl" }
                        },
                        "required": ["uiState", "controlText"]
                      },
                      "then": {
                        "type": "object",
                        "properties": {
                          "uiState": {
                            "type": "string",
                            "enum" : ["GameScreen","PlayerInventory", "BlockInventory", "PauseMenu","DeleteBar","Story","PlaceBlock"],
                            "default": "GameScreen"
                          },
                          "controlText": {
                            "type": "string",
                            "default": "control text"
                          }
                        }
                      }
                    },
                    {
                      "if": {
                        "properties": {
                          "tutorialType": { "const": "uiHighLight" }
                        },
                        "required": ["highLightUIObjectId", "highLightText"]
                      },
                      "then": {
                        "type": "object",
                        "properties": {
                          "highLightUIObjectId": {
                            "type": "string",
                            "default": "ui object id"
                          },
                          "highLightText": {
                            "type": "string",
                            "default": "highlight text"
                          }
                        }
                      }
                    }
                  ]
                }
              }
            }
          }
        }
      }
    }
  }
}
