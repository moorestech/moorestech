# Active Context

## 現在の作業の焦点

現在、moorestechプロジェクトのメモリバンクを整備しています。プロジェクトの概要、アーキテクチャ、主要モジュール、開発環境のセットアップなどの情報を整理し、今後の開発作業の基盤を構築しています。特に、アンロックシステムとチャレンジシステムに関する詳細な分析と文書化を行い、ゲームの進行メカニズムについての理解を深めています。

## 最近の変更点

- メモリバンクの初期化
- プロジェクトの概要、アーキテクチャ、技術スタックなどの情報の整理
- アンロックシステムに関する詳細な分析と文書化
- チャレンジシステムに関する詳細な分析と文書化
- 現在挑戦中のチャレンジの永続化の実装
- CIがサブモジュールに対応するようワークフローを修正

## 次のステップ

1. **プロジェクトの詳細な分析**: サーバーとクライアントのコードベースをより詳細に分析し、理解を深める
2. **開発環境のセットアップ**: 開発環境を整え、プロジェクトをビルドして実行できるようにする
3. **機能の実装または改善**: プロジェクトの要件に基づいて、新機能の実装または既存機能の改善を行う
4. **テストの実施**: 実装した機能のテストを行い、品質を確保する
5. **他のシステムの詳細分析**: クラフトシステム、ブロックシステム、液体システムなど、他の主要システムの詳細分析と文書化

## アクティブな決定事項や考慮事項

- **アーキテクチャの理解**: クライアント・サーバーアーキテクチャの理解と、それに基づいた開発アプローチの決定
- **液体システムの理解**: 液体システムのアーキテクチャ、主要クラス（FluidStack、FluidContainer、FluidMaster）、および液体の流れの制御方法の理解
- **コーディング規約の遵守**: プロジェクトのコーディング規約に従った開発の実施
- **パフォーマンスの考慮**: ゲームのパフォーマンスを考慮した実装の検討
- **拡張性の確保**: MODシステムなどを通じた拡張性の確保
- **アンロックシステムの活用**: ゲームの進行に応じたコンテンツの段階的な解放の設計
- **チャレンジシステムの活用**: プレイヤーに目標を提供し、ゲームの進行を導くチャレンジの設計

## 重要なパターンや好み

- **依存性注入（DI）パターン**: サーバー側では`Microsoft.Extensions.DependencyInjection`、クライアント側では`VContainer`を使用
- **コンポーネントパターン**: ブロックやエンティティなどのゲームオブジェクトをコンポーネントの集合として実装
- **イベント駆動型アーキテクチャ**: コンポーネント間の通信にイベント駆動型のアプローチを使用
- **ファクトリーパターン**: アイテムやブロックの作成にファクトリーパターンを使用
- **シングルトンパターン**: マスターデータやデータストアなどのグローバルなサービスにシングルトンパターンを使用
- **オブザーバーパターン**: アンロックイベントやチャレンジ完了イベントなどの通知にオブザーバーパターンを使用
- **ストラテジーパターン**: チャレンジの種類に応じた異なる実装をストラテジーパターンで切り替え

## 学習事項やプロジェクトの洞察

- **クライアント・サーバーアーキテクチャ**: ゲームロジックとUI/プレイヤー操作の分離による柔軟性と拡張性の確保
- **コンポーネント指向設計**: 単一責任の原則に基づいたコンポーネント指向設計による保守性の向上
- **イベント駆動型プログラミング**: イベントを通じたコンポーネント間の疎結合な通信による柔軟性の確保
- **MODシステム**: ゲームの拡張性を高めるMODシステムの実装
- **アンロックシステム**: ゲームの進行に応じたコンテンツの段階的な解放による学習曲線の設計と長期的なプレイ体験の提供
- **チャレンジシステム**: プレイヤーに目標を提供し、ゲームの進行を導くチャレンジの設計
- **システム間の連携**: アンロックシステム、チャレンジシステム、クラフトシステム、液体システムなど、システム間の連携による統合的なゲーム体験の設計
- **液体システムのフロー**: 液体は、クラフト連鎖システムによって管理されるレシピに基づいて生成され、パイプを通じて輸送され、`PreviousSourceFluidContainers` を使用して液体の流れを制御し、循環を防ぐ
- **Fluid inventory refactoring**: Simplified IFluidInventory and adjusted FluidPipeComponent.
